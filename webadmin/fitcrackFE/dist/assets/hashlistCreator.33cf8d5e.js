var p=Object.defineProperty,u=Object.defineProperties;var v=Object.getOwnPropertyDescriptors;var r=Object.getOwnPropertySymbols;var m=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;var l=(t,e,a)=>e in t?p(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,i=(t,e)=>{for(var a in e||(e={}))m.call(e,a)&&l(t,a,e[a]);if(r)for(var a of r(e))f.call(e,a)&&l(t,a,e[a]);return t},h=(t,e)=>u(t,v(e));import{F as _}from"./fileUploader.4d2d0428.js";import{f as y}from"./fc_textarea.3d72ea67.js";import{n as x}from"./index.da48d82d.js";var b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",[a("v-card",[a("v-tabs",{attrs:{grow:"","icons-and-text":""},model:{value:t.modetab,callback:function(s){t.modetab=s},expression:"modetab"}},[a("v-tab",{attrs:{id:"input-manual"}},[t._v(" Manual Input "),a("v-icon",[t._v("mdi-playlist-edit")])],1),a("v-tab",{attrs:{id:"input-file"}},[t._v(" Hashlist file "),a("v-icon",[t._v("mdi-file-upload")])],1),a("v-tab",{attrs:{id:"input-extract"}},[t._v(" Hash Extractor "),a("v-icon",[t._v("mdi-eye-lock-open")])],1)],1),a("v-container",[a("v-row",[a("v-col",[a("v-fade-transition",{attrs:{mode:"out-in"}},[t.mode!=="extract"?a("v-autocomplete",{attrs:{id:"hash-type-select",autofocus:"",clearable:"",label:"Select hash type",items:t.hashTypes,"item-text":"name","return-object":"",required:"","hide-details":"",outlined:"",disabled:t.mode==="extract","no-data-text":"No matching hash type"},scopedSlots:t._u([{key:"item",fn:function(s){var o=s.item;return[a("v-list-item-content",[a("v-list-item-title",[a("b",[t._v(t._s(o.code))]),t._v(" - "+t._s(o.name))])],1)]}}],null,!1,4127410718),model:{value:t.hashType,callback:function(s){t.hashType=s},expression:"hashType"}}):a("v-alert",{staticClass:"my-2",attrs:{type:"info",dense:"",text:""}},[t._v(" Hash type will be determined automatically ")])],1)],1)],1)],1),a("v-divider"),a("v-tabs-items",{model:{value:t.modetab,callback:function(s){t.modetab=s},expression:"modetab"}},[a("v-tab-item",{attrs:{eager:""}},[a("v-container",[a("v-row",[a("v-col",[a("fc-textarea",{ref:"textarea",staticClass:"textarea",attrs:{id:"hashes-input","max-height":"500","can-remove-line":!0},model:{value:t.hashListManual,callback:function(s){t.hashListManual=s},expression:"hashListManual"}})],1)],1)],1)],1),a("v-tab-item",{attrs:{eager:""}},[a("v-container",[a("v-row",[a("v-col",[a("file-uploader",{ref:"listUploader",attrs:{"no-upload":"",multiple:!1,label:"Select hashlist file to add"}})],1)],1)],1)],1),a("v-tab-item",{attrs:{eager:""}},[a("v-container",[a("v-row",[a("v-col",[a("file-uploader",{ref:"extractUploader",attrs:{"no-upload":"",multiple:!1,label:"Select protected file to extract"}}),a("v-alert",{attrs:{type:"warning"}},[a("strong",[t._v("Supported formats: ")]),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(s){var o=s.on;return[a("span",t._g({},o),[t._v("MS_OFFICE,")])]}}])},[a("span",[t._v("Hash types: 9400, 9500, 9600, 9700, 9800")])]),t._v("\xA0 "),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(s){var o=s.on;return[a("span",t._g({},o),[t._v("PDF,")])]}}])},[a("span",[t._v("Hash types: 10400, 10500, 10600, 10700")])]),t._v("\xA0 "),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(s){var o=s.on;return[a("span",t._g({},o),[t._v("7Z,")])]}}])},[a("span",[t._v("Hash type: 11600")])]),t._v("\xA0 "),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(s){var o=s.on;return[a("span",t._g({},o),[t._v("RAR")])]}}])},[a("span",[t._v("Hash types: 12500, 13000, 23700, 23800")])]),t._v(" and "),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(s){var o=s.on;return[a("span",t._g({},o),[t._v("ZIP.")])]}}])},[a("span",[t._v("Hash types: 13600, 17200, 17210, 17225, 13001, 23002, 23003")])])],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)},g=[];const c={withCredentials:!0,headers:{"Content-type":"multipart/form-data"}},w={name:"hashlistCreator",props:{hashlistName:String,autofocus:Boolean},data(){return{modetab:0,hashType:{name:""},hashListManual:"",hashTypes:[]}},computed:{mode(){return["manual","upload","extract"][this.modetab]},valid(){switch(this.mode){case"manual":return this.hashType.name.length>0&&this.hashListManual.length>0;case"upload":return this.hashType.name.length>0&&this.$refs.listUploader.selectedFiles.length==1;case"extract":return this.$refs.extractUploader.selectedFiles.length==1;default:return!1}},hashesManual(){return this.hashListManual.split(`
`).map(t=>({hash:t}))},hashCode(){return parseInt(this.hashType.code)}},watch:{valid(t){this.$emit("validation",!!t)}},methods:{getHashTypes(){this.axios.get(this.$serverAddr+"/hashcat/hashTypes").then(t=>{this.hashTypes=t.data.hashtypes})},createHashlist(){return new Promise((t,e)=>{this.valid||e("Invalid input");const a=`${this.$serverAddr}/hashlist`;console.log(a),this.axios.post(a,{name:this.hashlistName},{withCredentials:!0}).then(s=>{const o=s.data.id;switch(this.mode){case"manual":this.axios.post(`${a}/${o}/hashes`,{hash_type:this.hashCode.toString(),hash_list:this.hashesManual,valid_only:!1},{withCredentials:!0}).then(t).catch(n=>{e(n)});break;case"upload":this.axios.post(`${a}/${o}/file`,this.$refs.listUploader.files,h(i({},c),{params:{hash_type:this.hashCode,valid_only:!0,binary:!1}})).then(t).catch(n=>{e(n)});break;case"extract":this.axios.post(`${a}/${o}/extract`,this.$refs.extractUploader.files,i({},c)).then(t).catch(n=>{e(n)});break;default:e("Unknown hash input mode, what the what??")}}).catch(s=>{e(s)})})}},mounted(){this.getHashTypes()},components:{FileUploader:_,fcTextarea:y}},d={};var k=x(w,b,g,!1,$,null,null,null);function $(t){for(let e in d)this[e]=d[e]}var M=function(){return k.exports}();export{M as H};
