var v=Object.defineProperty,p=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var l=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;var h=(t,s,a)=>s in t?v(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,o=(t,s)=>{for(var a in s||(s={}))_.call(s,a)&&h(t,a,s[a]);if(l)for(var a of l(s))f.call(s,a)&&h(t,a,s[a]);return t},r=(t,s)=>p(t,u(s));import{F as m}from"./fileUploader.a2fb854c.js";import{f as y}from"./fc_textarea.0ca8a043.js";import{H as x}from"./hashTypeAutocomplete.47d5ad19.js";import{n as g}from"./index.4da83f88.js";var b=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("v-container",[a("v-row",[a("v-col",[a("v-card",[a("v-tabs",{attrs:{grow:"","icons-and-text":""},model:{value:t.modetab,callback:function(e){t.modetab=e},expression:"modetab"}},[a("v-tab",{attrs:{id:"input-manual"}},[t._v(" Manual Input "),a("v-icon",[t._v("mdi-playlist-edit")])],1),a("v-tab",{attrs:{id:"input-file"}},[t._v(" Hashlist file "),a("v-icon",[t._v("mdi-file-upload")])],1),a("v-tab",{attrs:{id:"input-extract",disabled:!!t.existing&&!t.existingTypeCanBeExtracted}},[t._v(" "+t._s(!!t.existing&&!t.existingTypeCanBeExtracted?"Cannot extract this type":"Hash Extractor")+" "),a("v-icon",[t._v("mdi-eye-lock-open")])],1)],1),a("v-container",[a("v-row",[a("v-col",[a("v-fade-transition",{attrs:{mode:"out-in"}},[t.mode!=="extract"?a("div",{staticClass:"d-flex align-center"},[a("hashTypeAutocomplete",{attrs:{required:"",outlined:"",dense:"",label:"Select hash type",disabled:t.mode==="extract"||!!t.existing},on:{input:t.revalidate},model:{value:t.hashType,callback:function(e){t.hashType=e},expression:"hashType"}}),a("div",{staticClass:"text-overline ml-6 mr-2 text--secondary"},[t._v(" Validation ")]),a("v-btn-toggle",{attrs:{mandatory:"","hide-details":"",dense:""},model:{value:t.validationMode,callback:function(e){t.validationMode=e},expression:"validationMode"}},[a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{value:"fail_invalid"}},i),[t._v(" Strict ")])]}}],null,!1,3690490359)},[a("span",[t._v("Any invalid hash encountered cancels the operation completely.")])]),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{value:"skip_invalid"}},i),[t._v(" Skipping ")])]}}],null,!1,3846275694)},[a("span",[t._v("Only valid hashes are saved, the rest is ignored.")])]),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({attrs:{value:"no_validate"}},i),[t._v(" None ")])]}}],null,!1,2409346562)},[a("span",[t._v("No checks are performed before saving the hashes.")])])],1)],1):a("v-alert",{staticClass:"my-0",attrs:{type:"info",dense:"",text:""}},[!!t.existing&&t.existingTypeCanBeExtracted?a("span",[a("strong",[t._v("Note:")]),t._v(" only "+t._s(t.hashType.name)+" will be accepted. ")]):!!t.existing&&!t.existingTypeCanBeExtracted?a("span",[a("strong",[t._v("Note:")]),t._v(" extracting hashes of type "+t._s(t.hashType.name)+" is not supported. ")]):a("span",[t._v("Hash type is determined automatically when extracting from protected files.")])])],1)],1)],1)],1),a("v-divider"),a("v-tabs-items",{model:{value:t.modetab,callback:function(e){t.modetab=e},expression:"modetab"}},[a("v-tab-item",{attrs:{eager:""}},[a("v-container",[a("v-row",[a("v-col",[a("fc-textarea",{ref:"textarea",staticClass:"textarea",attrs:{id:"hashes-input","max-height":"500","can-remove-line":!0,loading:t.processing},on:{input:t.revalidate},model:{value:t.hashListManual,callback:function(e){t.hashListManual=e},expression:"hashListManual"}},[a("div",{staticClass:"hashCheckContainer pl-1 pt-2",attrs:{slot:"after"},slot:"after"},t._l(t.checkedHashesResults,function(e){return a("div",{key:e.id},[e.result==="OK"?a("v-icon",{attrs:{small:"",color:"success"}},[t._v(" check_circle_outlined ")]):a("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[a("v-icon",t._g({staticClass:"clickable",attrs:{small:"",color:"error"}},n),[t._v(" error_circle_outlined ")])]}}],null,!0)},[a("span",[t._v(t._s(e.result))])]),e.isInCache?a("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(i){var n=i.on;return[a("v-icon",t._g({staticClass:"clickable",attrs:{small:"",color:"warning"}},n),[t._v(" error_circle_outlined ")])]}}],null,!0)},[a("span",[t._v("hash already in hashcache")])]):t._e()],1)}),0)])],1)],1)],1)],1),a("v-tab-item",{attrs:{eager:""}},[a("v-container",[a("v-row",[a("v-col",[a("div",{staticClass:"d-flex mx-3 mb-4"},[a("v-checkbox",{attrs:{label:"Treat as a binary hashlist file","hide-details":""},model:{value:t.isBinaryHashlist,callback:function(e){t.isBinaryHashlist=e},expression:"isBinaryHashlist"}})],1),a("file-uploader",{ref:"listUploader",attrs:{"no-upload":"",multiple:!1,label:"Select hashlist file to add"}})],1)],1)],1)],1),a("v-tab-item",{attrs:{eager:""}},[a("v-container",[a("v-row",[a("v-col",[a("file-uploader",{ref:"extractUploader",attrs:{"no-upload":"",multiple:!1,label:"Select protected file to extract"}}),a("v-alert",{attrs:{type:"warning"}},[a("strong",[t._v("Supported formats: ")]),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("span",t._g({},i),[t._v("MS_OFFICE,")])]}}])},[a("span",[t._v("Hash types: 9400, 9500, 9600, 9700, 9800")])]),t._v("\xA0 "),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("span",t._g({},i),[t._v("PDF,")])]}}])},[a("span",[t._v("Hash types: 10400, 10500, 10600, 10700")])]),t._v("\xA0 "),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("span",t._g({},i),[t._v("7Z,")])]}}])},[a("span",[t._v("Hash type: 11600")])]),t._v("\xA0 "),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("span",t._g({},i),[t._v("RAR")])]}}])},[a("span",[t._v("Hash types: 12500, 13000, 23700, 23800")])]),t._v(" and "),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("span",t._g({},i),[t._v("ZIP.")])]}}])},[a("span",[t._v("Hash types: 13600, 17200, 17210, 17225, 13001, 23002, 23003")])]),t._v(" Hover each to see codes. ")],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)},k=[];const d={withCredentials:!0,headers:{"Content-type":"multipart/form-data"}},C={name:"hashlistCreator",props:{hashlistName:String,hashlistId:Number,autofocus:Boolean},data(){return{processing:!1,modetab:0,hashType:{name:""},hashListManual:"",checkedHashesResults:[],checkingError:!1,existing:null,isBinaryHashlist:!1,validationMode:"fail_invalid",extractableHashTypes:[9400,9500,9600,9700,9800,10400,10500,10600,10700,11600,12500,13e3,23700,23800,13600,17200,17210,17225,13001,23002,23003]}},computed:{mode(){return["manual","upload","extract"][this.modetab]},validNameOrId(){return this.hashlistName.length>0||typeof this.hashlistId=="number"},validManualEntry(){if(this.checkingError&&this.validationMode==="fail_invalid")return!1;const t=this.checkedHashesResults.filter(s=>s.result==="OK").length;return this.validationMode==="skip_invalid"?t>0:this.hashListManual.length>0},valid(){switch(this.mode){case"manual":return this.validNameOrId&&this.hashCode!=null&&this.validManualEntry;case"upload":return this.validNameOrId&&this.hashCode!=null&&this.$refs.listUploader.selectedFiles.length==1;case"extract":return this.validNameOrId&&this.$refs.extractUploader.selectedFiles.length==1;default:return!1}},hashesManual(){return this.hashListManual.split(`
`).map(t=>({hash:t}))},hashCode(){return this.hashType?parseInt(this.hashType.code):null},existingTypeCanBeExtracted(){return this.existing?this.extractableHashTypes.includes(this.hashCode):!1},id(){return this.hashlistId||"new"}},watch:{valid(t){this.$emit("validation",!!t)}},mounted(){this.id!=="new"&&this.loadExistingHahslistInfo()},methods:{async loadExistingHahslistInfo(){const t=await this.axios.get(this.$serverAddr+"/hashcat/hashTypes").then(s=>s.data.hashtypes);this.axios.get(`${this.$serverAddr}/hashlist/${this.id}`).then(s=>{const a=s.data;this.hashType=t.find(e=>e.name===a.hash_type_name),this.existing=a})},revalidate(){this.processing=!0,this.checkedHashesErrors=[],this.checkedHashesResults=[],this.axios.post(this.$serverAddr+"/job/verifyHash",{hashtype:this.hashCode,hashes:this.hashListManual}).then(t=>{this.checkingError=t.data.error,this.checkedHashesResults=t.data.items}).finally(()=>{this.processing=!1})},createHashlist(){return new Promise((t,s)=>{this.valid||s("Invalid input");const a=`${this.$serverAddr}/hashlist`;switch(this.mode){case"manual":this.axios.post(`${a}/${this.id}/hashes`,{name:this.hashlistName,hash_type:this.hashCode,hash_list:this.hashesManual,validation_mode:this.validationMode},{withCredentials:!0}).then(t).catch(e=>{s(e)});break;case"upload":this.axios.post(`${a}/${this.id}/file`,this.$refs.listUploader.files,r(o({},d),{params:{name:this.hashlistName,hash_type:this.hashCode,validation_mode:this.validationMode,binary:this.isBinaryHashlist}})).then(t).catch(e=>{s(e)});break;case"extract":this.axios.post(`${a}/${this.id}/extract`,this.$refs.extractUploader.files,r(o({},d),{params:{name:this.hashlistName}})).then(t).catch(e=>{s(e)});break;default:s("Unknown hash input mode, what the what??")}})}},components:{FileUploader:m,fcTextarea:y,hashTypeAutocomplete:x}},c={};var H=g(C,b,k,!1,T,null,null,null);function T(t){for(let s in c)this[s]=c[s]}var I=function(){return H.exports}();export{I as H};
